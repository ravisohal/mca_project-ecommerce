<!-- order-detail.html -->
<div class="p-6 md:p-10 bg-gray-100 min-h-screen">
    <div class="max-w-4xl mx-auto">
        <!-- Back button -->
        <a routerLink="/orders" class="flex items-center text-indigo-600 hover:text-indigo-800 transition-colors mb-6">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd"
                    d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z"
                    clip-rule="evenodd" />
            </svg>
            Back to Orders
        </a>

        <!-- Loading state -->
        <div *ngIf="loading()" class="text-center py-20 text-gray-500 text-lg">
            <svg class="animate-spin h-8 w-8 text-indigo-500 mx-auto mb-4" xmlns="http://www.w3.org/2000/svg"
                fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                </path>
            </svg>
            <p>Loading order details...</p>
        </div>

        <!-- Not found state -->
        <div *ngIf="!loading() && !order()" class="text-center py-20">
            <div class="bg-white p-8 rounded-xl shadow-lg">
                <p class="text-xl text-gray-600 mb-4">Order not found.</p>
                <p class="text-gray-500 mb-6">The order you're looking for does not exist or you do not have permission
                    to view it.</p>
                <a routerLink="/orders"
                    class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-full shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 transition-colors">
                    View All Orders
                </a>
            </div>
        </div>

        <!-- Order details -->
        @if (!loading() && order()) {
        <div class="bg-white rounded-xl shadow-lg p-8 md:p-10">
            <!-- Order Header -->
            <div class="flex items-center justify-between border-b pb-6 mb-6">
                <div>
                    <h1 class="text-2xl md:text-3xl font-bold text-gray-900">Order #{{ order()?.id }}</h1>
                    <p class="text-sm text-gray-500">Placed on {{ order()?.createdAt | date:'medium' }}</p>
                </div>
                <span class="px-4 py-2 text-sm font-extrabold rounded-full" [ngClass]="{
            'bg-green-100 text-green-800': order()?.status === OrderStatus.COMPLETED,
            'bg-yellow-100 text-yellow-800': order()?.status === OrderStatus.IN_FULFILLMENT,
            'bg-blue-100 text-blue-800': order()?.status === OrderStatus.PENDING
          }">{{ order()?.status }}</span>
            </div>

            <!-- Order Summary -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                <div>
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">Order Summary</h2>
                    <div class="space-y-2 text-gray-600">
                        <div class="flex justify-between">
                            <span>Subtotal:</span>
                            <span class="font-medium">${{ order()?.totalAmount | number:'1.2-2' }}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Shipping:</span>
                            <span class="font-medium">FREE</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Tax:</span>
                            <span class="font-medium">INCLUDED</span>
                        </div>
                        <div class="flex justify-between font-bold text-lg text-gray-900 border-t pt-2 mt-2">
                            <span>Total:</span>
                            <span>${{ order()?.totalAmount | number:'1.2-2' }}</span>
                        </div>
                    </div>
                </div>

                <!-- Shipping Details -->
                <div>
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">Shipping Details</h2>
                    <div *ngIf="order()?.shippingAddress" class="text-gray-600">
                        <p class="font-medium">{{ order()?.shippingAddress?.street }}</p>
                        <p>{{ order()?.shippingAddress?.city }}, {{ order()?.shippingAddress?.state }} {{
                            order()?.shippingAddress?.postalCode }}</p>
                        <p>{{ order()?.shippingAddress?.country }}</p>
                    </div>
                </div>
            </div>

            <!-- Items List -->
            <div *ngIf="order()?.orderItems" class="border-t pt-8">
                <h2 class="text-xl font-semibold text-gray-800 mb-6">Items in Your Order</h2>
                <div class="space-y-6">
                    <div *ngFor="let item of order()?.orderItems" class="flex items-start gap-4">
                        <!-- Product Image -->
                        <img [src]="item.product.imageUrl || 'https://placehold.co/100x100/e2e8f0/64748b?text=No+Image'"
                            alt="{{ item.product.name }}" class="w-20 h-20 object-cover rounded-lg shadow-md">
                        <!-- Product Info -->
                        <div class="flex-grow">
                            <h3 class="text-lg font-semibold text-gray-800">{{ item.product.name }}</h3>
                            <p class="text-sm text-gray-500 mb-2">{{ item.product.description | slice:0:100 }}...</p>
                            <div class="flex items-center justify-between text-gray-600">
                                <span class="text-sm font-medium">Price: ${{ item.price | number:'1.2-2' }}</span>
                                <span class="text-sm font-medium">Quantity: {{ item.quantity }}</span>
                                <span class="font-bold text-gray-900">${{ item.total | number:'1.2-2' }}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        }
    </div>
</div>