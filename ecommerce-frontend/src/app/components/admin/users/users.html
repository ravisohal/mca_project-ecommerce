<div class="p-8">
    <div class="flex justify-between items-center">
        <h1 class="text-3xl font-bold text-gray-800">User Management</h1>
    </div>

    <div *ngIf="showEditor()" class="mt-6 bg-white shadow rounded-xl p-4">
        <h2 class="font-semibold mb-4">{{ editId() ? 'Edit User' : 'Add User' }}</h2>
        <form [formGroup]="form" class="grid md:grid-cols-2 gap-4">
            <div class="grid grid-cols-2 gap-4">
                <label class="block">
                    <span class="text-sm text-gray-600">Username</span>
                    <input formControlName="username" class="mt-1 w-full border rounded-lg px-3 py-2" />
                </label>

                <label class="block" *ngIf="!editId()">
                    <span class="text-sm text-gray-600">Password</span>
                    <input type="password" formControlName="password" class="mt-1 w-full border rounded-lg px-3 py-2" />
                </label>

                <label class="block">
                    <span class="text-sm text-gray-600">First Name</span>
                    <input formControlName="firstname" class="mt-1 w-full border rounded-lg px-3 py-2" />
                </label>

                <label class="block">
                    <span class="text-sm text-gray-600">Last Name</span>
                    <input formControlName="lastname" class="mt-1 w-full border rounded-lg px-3 py-2" />
                </label>

                <label class="block">
                    <span class="text-sm text-gray-600">Email</span>
                    <input type="email" formControlName="email" class="mt-1 w-full border rounded-lg px-3 py-2" />
                </label>

                <label class="block">
                    <span class="text-sm text-gray-600">Phone Number</span>
                    <input formControlName="phoneNumber" class="mt-1 w-full border rounded-lg px-3 py-2" />
                </label>
            </div>

            <!-- Role -->
            <label class="block">
                <span class="text-sm text-gray-600">Role</span>
                <select formControlName="role" class="mt-1 w-full border rounded-lg px-3 py-2">
                    <option value="customer">Customer</option>
                    <option value="admin">Admin</option>
                </select>
            </label>

            <!-- Addresses -->
            <fieldset class="border rounded-lg p-4">
                <legend class="text-sm font-semibold text-gray-700">Shipping Address</legend>
                <div class="grid grid-cols-2 gap-4 mt-2">
                    <input placeholder="Street" formControlName="shippingStreet" class="border rounded-lg px-3 py-2" />
                    <input placeholder="City" formControlName="shippingCity" class="border rounded-lg px-3 py-2" />
                    <input placeholder="State" formControlName="shippingState" class="border rounded-lg px-3 py-2" />
                    <input placeholder="Postal Code" formControlName="shippingPostalCode"
                        class="border rounded-lg px-3 py-2" />
                    <input placeholder="Country" formControlName="shippingCountry"
                        class="border rounded-lg px-3 py-2" />
                </div>
            </fieldset>

            <fieldset class="border rounded-lg p-4">
                <legend class="text-sm font-semibold text-gray-700">Billing Address</legend>
                <div class="grid grid-cols-2 gap-4 mt-2">
                    <input placeholder="Street" formControlName="billingStreet" class="border rounded-lg px-3 py-2" />
                    <input placeholder="City" formControlName="billingCity" class="border rounded-lg px-3 py-2" />
                    <input placeholder="State" formControlName="billingState" class="border rounded-lg px-3 py-2" />
                    <input placeholder="Postal Code" formControlName="billingPostalCode"
                        class="border rounded-lg px-3 py-2" />
                    <input placeholder="Country" formControlName="billingCountry" class="border rounded-lg px-3 py-2" />
                </div>
            </fieldset>


            <div class="flex gap-4 mt-2 md:col-span-2">
                <button
                    class="px-4 py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 disabled:opacity-50"
                    [disabled]="form.invalid" (click)="save()">
                    Save
                </button>
                <button class="px-4 py-2 bg-gray-300 text-gray-800 font-semibold rounded-lg shadow-md hover:bg-gray-400"
                    (click)="showEditor.set(false)">
                    Cancel
                </button>
            </div>
        </form>
    </div>

    <div class="mt-6 overflow-x-auto bg-white shadow rounded-xl">
        <table class="min-w-full text-sm text-left text-gray-500">
            <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                <tr>
                    <th class="px-6 py-3">ID</th>
                    <th class="px-6 py-3">Username</th>
                    <th class="px-6 py-3">Name</th>
                    <th class="px-6 py-3">Email</th>
                    <th class="px-6 py-3">Role</th>
                    <th class="px-6 py-3">Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let user of users()" class="bg-white border-b hover:bg-gray-50">
                    <td class="px-6 py-4 font-medium text-gray-900">{{ user.id }}</td>
                    <td class="px-6 py-4">{{ user.username }}</td>
                    <td class="px-6 py-4">{{ user.firstname }} {{ user.lastname }}</td>
                    <td class="px-6 py-4">{{ user.email }}</td>
                    <td class="px-6 py-4 capitalize">{{ user.role }}</td>
                    <td class="px-6 py-4 flex gap-2">
                        <button (click)="editUser(user)" class="text-indigo-600 hover:text-indigo-900 font-semibold">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20"
                                fill="currentColor">
                                <path
                                    d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" />
                                <path fill-rule="evenodd"
                                    d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"
                                    clip-rule="evenodd" />
                            </svg>
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
        <p *ngIf="!users().length" class="text-center py-4 text-gray-400">No users found.</p>
    </div>
</div>